nz = len(z)
nx = len(x)
points_num = 2*nx
points = points_SRCKF(x, S, ksi)
points_h = np.zeros((points_num, nz))
for i in range(points_num):
    points_h[i] = apply_H_SRCKF_station(H_SRCKF_station, points[i], t, stationPos0)

zp, Sz =  SRCT(points_h, W, R)

Pz = np.dot(Sz, Sz.T)
x_residual = (points - x)/np.sqrt(2*nx)
z_residual = (points_h - zp)/np.sqrt(2*nx)
Pxz = np.dot(x_residual.T,z_residual)
K = np.dot(Pxz, np.linalg.inv(Pz))

x_next = x + np.dot(K, z - zp)
M = np.concatenate((x_residual.T - np.dot(K,z_residual.T), np.dot(K,scipy.linalg.cholesky(R, lower=True))), axis=1)
Q, R = np.linalg.qr(M.T)
S_next = R.T
return x_next, S_next